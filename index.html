<!DOCTYPE html>
<html lang="en">

<!--
╔══════════════════════════════════════════════════╗
║                                                  ║
║                 DOM amb la firma                 ║
║                                                  ║
╚══════════════════════════════════════════════════╝
-->

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Mar Kralovna</title>
	<script src="recursos/llibreries/p5js/p5.js"></script>
</head>

<body onclick=" location.href = 'gallery' "></body>





<!--
╔══════════════════════════════════════════════════╗
║                                                  ║
║                      ESTILS                      ║
║                                                  ║
╚══════════════════════════════════════════════════╝
-->


<style>
	body {
		margin: 0;
		height: 100vh;
		width: 100vw;
		overflow: hidden;
		background: hsl(0, 0%, 13%);
	}
</style>





<!--
╔══════════════════════════════════════════════════╗
║                                                  ║
║          lÒGICA de la geomatria de fons          ║
║                                                  ║
╚══════════════════════════════════════════════════╝
-->


<script>
	const MODE_DEBUG = false;
	const planets = [];
	let text;

	const p = [[22,36],[22,37],[22,38],[23,37],[23,38],[23,39],[23,40],[24,38],[24,39],[24,40],[24,41],[24,42],[25,40],[25,41],[25,42],[25,43],[25,44],[26,42],[26,43],[26,44],[26,45],[26,46],[27,44],[27,45],[27,46],[27,47],[27,48],[28,46],[28,47],[28,48],[28,49],[28,50],[29,48],[29,49],[29,50],[29,51],[29,52],[30,50],[30,51],[30,52],[30,53],[30,54],[31,52],[31,53],[31,54],[31,55],[31,56],[32,54],[32,55],[32,56],[32,57],[32,58],[33,57],[33,58],[33,59],[33,60],[34,59],[34,60],[34,61],[34,62],[35,60],[35,61],[35,62],[35,63],[35,64],[36,63],[36,64],[36,65],[36,66],[36,67],[37,65],[37,66],[37,67],[37,68],[38,67],[38,68],[39,67],[39,68],[39,69],[40,67],[40,68],[40,69],[41,65],[41,66],[41,67],[41,68],[42,64],[42,65],[42,66],[42,67],[43,63],[43,64],[43,65],[44,62],[44,63],[45,60],[45,61],[45,62],[46,58],[46,59],[46,60],[46,61],[47,57],[47,58],[47,59],[48,56],[48,57],[48,58],[49,55],[49,56],[50,54],[50,55],[50,56],[51,53],[51,54],[51,55],[52,51],[52,52],[52,53],[53,50],[53,51],[53,52],[54,49],[54,50],[54,51],[55,49],[55,50],[56,48],[56,49],[57,47],[57,48],[58,46],[58,47],[59,45],[59,46],[59,47],[60,44],[60,45],[60,46],[61,43],[61,44],[61,45],[62,43],[62,44],[63,42],[63,43],[63,44],[64,42],[64,43],[64,44],[65,41],[65,42],[65,43],[66,41],[66,42],[67,40],[67,41],[67,42],[68,40],[68,41],[68,42],[69,40],[69,41],[70,40],[70,41],[71,39],[71,40],[71,41],[72,39],[72,40],[73,39],[73,40],[74,39],[74,40],[75,38],[75,39],[75,40],[76,38],[76,39],[77,38],[77,39],[78,38],[78,39],[79,38],[79,39],[80,37],[80,38],[80,39],[81,37],[81,38],[81,39],[82,37],[82,38],[82,39],[83,38],[83,39],[84,38],[84,39],[85,39],[85,40],[86,39],[86,40],[86,41],[87,40],[87,41],[87,42],[88,41],[88,42],[88,43],[89,42],[89,43],[90,43],[90,44],[91,44],[91,45],[92,45],[92,46],[93,45],[93,46],[93,47],[94,46],[94,47],[94,48],[94,49],[95,47],[95,48],[95,49],[95,50],[96,49],[96,50],[96,51],[96,52],[96,53],[97,51],[97,52],[97,53],[97,54],[97,55],[98,54],[98,55],[98,56],[99,55],[99,56],[99,57],[99,58],[100,56],[100,57],[100,58],[100,59],[100,60],[100,61],[100,62],[100,63],[100,64],[101,59],[101,60],[101,61],[101,62],[101,63],[101,64],[101,65],[101,66],[102,62],[102,63],[102,64],[102,65],[102,66],[103,62],[103,63],[103,64],[103,65],[104,60],[104,61],[104,62],[104,63],[105,59],[105,60],[105,61],[105,62],[106,58],[106,59],[106,60],[107,56],[107,57],[107,58],[107,59],[108,55],[108,56],[108,57],[109,53],[109,54],[109,55],[110,53],[110,54],[111,52],[111,53],[112,51],[112,52],[113,50],[113,51],[114,49],[114,50],[114,51],[115,48],[115,49],[115,50],[116,47],[116,48],[116,49],[117,46],[117,47],[117,48],[118,45],[118,46],[118,47],[119,44],[119,45],[119,46],[120,44],[120,45],[121,43],[121,44],[121,45],[122,43],[122,44],[122,45],[123,42],[123,43],[123,44],[124,42],[124,43],[125,41],[125,42],[125,43],[126,41],[126,42],[127,41],[127,42],[128,41],[128,42],[129,40],[129,41],[129,42],[130,40],[130,41],[131,40],[131,41],[132,40],[132,41],[133,39],[133,40],[133,41],[134,39],[134,40],[135,38],[135,39],[135,40],[136,38],[136,39],[136,40],[137,39],[137,40],[138,39],[138,40],[138,41],[139,39],[139,40],[139,41],[140,39],[140,40],[140,41],[141,40],[141,41],[142,40],[142,41],[143,41],[143,42],[144,41],[144,42],[144,43],[145,42],[145,43],[146,43],[146,44],[147,44],[147,45],[148,45],[148,46],[149,45],[149,46],[149,47],[150,46],[150,47],[150,48],[150,49],[151,47],[151,48],[151,49],[151,50],[151,51],[151,52],[152,49],[152,50],[152,51],[152,52],[152,53],[153,52],[153,53],[153,54],[153,55],[154,54],[154,55],[154,56],[154,57],[155,55],[155,56],[155,57],[155,58],[155,59],[155,60],[156,58],[156,59],[156,60],[156,61],[156,62],[157,61],[157,62],[157,63],[157,64],[157,65],[158,63],[158,64],[158,65],[158,66],[159,65],[159,66],[159,67],[159,68],[160,66],[160,67],[160,68],[160,69],[160,70],[161,66],[161,67],[161,68],[161,69],[162,65],[162,66],[162,67],[163,64],[163,65],[163,66],[164,63],[164,64],[164,65],[165,62],[165,63],[165,64],[166,61],[166,62],[166,63],[167,60],[167,61],[167,62],[168,59],[168,60],[168,61],[169,58],[169,59],[169,60],[170,57],[170,58],[170,59],[171,56],[171,57],[171,58],[172,55],[172,56],[173,55],[173,56],[174,54],[174,55],[175,53],[175,54],[176,53],[176,54],[177,52],[177,53],[178,51],[178,52],[179,50],[179,51],[179,52],[180,50],[180,51],[181,49],[181,50],[182,48],[182,49],[183,47],[183,48],[183,49],[184,47],[184,48],[185,46],[185,47],[186,45],[186,46],[186,47],[187,45],[187,46],[188,44],[188,45],[189,44],[189,45],[190,43],[190,44],[190,45],[191,43],[191,44],[192,42],[192,43],[193,42],[193,43],[194,41],[194,42],[195,41],[195,42],[196,40],[196,41],[197,40],[197,41],[198,40],[198,41],[199,39],[199,40],[200,39],[200,40],[200,41],[200,42],[202,38],[202,39],[202,40],[202,41],[203,41],[203,40],[203,39],[203,38],[204,37],[204,38],[204,39],[204,40],[205,38],[205,39],[201,39],[201,40],[201,41],[201,42],[201,43],[200,43],[200,44],[199,43],[199,44],[199,45],[199,46],[198,46],[198,45],[198,47],[196,47],[196,48],[196,49],[197,46],[197,47],[197,48],[195,48],[195,49],[195,50],[194,49],[194,50],[194,51],[193,51],[194,52],[193,52],[194,53],[193,53],[192,54],[193,54],[192,55],[193,55],[192,56],[192,57],[192,58],[192,59],[191,56],[191,57],[191,58],[191,59],[191,60],[191,61],[191,62],[191,63],[191,64],[191,65],[193,65],[193,66],[193,67],[194,66],[194,67],[194,68],[190,59],[190,60],[190,61],[190,62],[190,63],[192,64],[192,65],[192,66],[195,67],[195,68],[196,68],[196,69],[197,68],[197,69],[198,69],[198,70],[199,69],[199,70],[200,70],[200,71],[201,70],[201,71],[201,72],[202,70],[202,71],[202,72],[203,70],[203,71],[203,72],[204,70],[204,71],[204,72],[205,70],[205,71],[206,69],[206,70],[206,71],[207,69],[207,70],[207,71],[208,69],[208,70],[208,71],[209,69],[209,70],[210,69],[210,70],[211,69],[211,70],[212,68],[212,69],[213,68],[213,69],[214,68],[214,69],[215,67],[215,68],[216,67],[216,68],[217,67],[217,68],[218,66],[218,67],[219,66],[219,67],[220,65],[220,66],[220,67],[221,64],[221,65],[221,66],[222,64],[222,65],[223,63],[223,64],[224,62],[224,63],[224,64],[225,62],[225,63],[226,61],[226,62],[227,60],[227,61],[228,60],[228,61],[229,59],[229,60],[230,58],[230,59],[231,58],[231,59],[232,57],[232,58],[233,56],[233,57],[234,55],[234,56],[234,57],[235,55],[235,56],[236,54],[236,55],[237,53],[237,54],[238,52],[238,53],[238,54],[239,51],[239,52],[239,53],[240,50],[240,51],[240,52],[241,49],[241,50],[241,51],[242,48],[242,49],[242,50],[243,48],[243,49],[244,47],[244,48],[245,46],[245,47],[245,48],[246,45],[246,46],[246,47],[247,44],[247,45],[247,46],[248,43],[248,44],[249,42],[249,43],[249,44],[250,41],[250,42],[250,43],[251,42],[251,43],[251,44],[252,43],[252,44],[252,45],[253,44],[253,45],[253,46],[254,45],[254,46],[254,47],[255,46],[255,47],[255,48],[256,47],[256,48],[256,49],[257,48],[257,49],[257,50],[257,51],[258,50],[258,51],[258,52],[259,51],[259,52],[259,53],[260,52],[260,53],[260,54],[261,52],[261,53],[261,54],[261,55],[262,54],[262,55],[263,55],[263,56],[264,55],[264,56],[265,56],[265,57],[266,56],[266,57],[267,57],[267,58],[267,59],[268,57],[268,58],[268,59],[269,57],[269,58],[269,59],[270,57],[270,58],[270,59],[271,57],[271,58],[271,59],[272,57],[272,58],[272,59],[273,57],[273,58],[274,57],[274,58],[275,56],[275,57],[275,58],[276,55],[276,56],[276,57],[277,54],[277,55],[277,56],[278,53],[278,54],[278,55],[279,53],[279,54],[280,52],[280,53],[281,51],[281,52],[281,53],[282,51],[282,52],[283,50],[283,51],[284,49],[284,50],[285,48],[285,49],[285,50],[286,47],[286,48],[286,49],[287,46],[287,47],[287,48],[288,45],[288,46],[288,47],[289,44],[289,45],[289,46],[290,43],[290,44],[290,45],[291,43],[291,44],[292,42],[292,43],[292,44],[293,42],[293,43],[293,44],[294,41],[294,42],[294,43],[295,41],[295,42],[296,40],[296,41],[297,39],[297,40],[297,41],[298,39],[298,40],[299,38],[299,39],[300,37],[300,38],[300,39],[301,37],[301,38],[302,36],[302,37],[303,36],[303,37],[304,35],[304,36],[304,37],[305,35],[305,36],[306,35],[306,36],[307,34],[307,35],[307,36],[308,34],[308,35],[309,33],[309,34],[310,33],[310,34],[311,33],[311,34],[312,32],[312,33],[312,34],[313,32],[313,33],[313,34],[314,32],[314,33],[314,34],[315,32],[315,33],[315,34],[316,32],[316,33],[316,34],[317,32],[317,33],[317,34],[318,33],[318,34],[319,33],[319,34],[319,35],[319,36],[320,35],[320,36],[320,37],[321,36],[321,37],[321,38],[321,39],[322,37],[322,38],[322,39],[322,40],[322,41],[323,39],[323,40],[323,41],[323,42],[323,43],[324,41],[324,42],[324,43],[324,44],[325,43],[325,44],[325,45],[325,46],[326,44],[326,45],[326,46],[326,47],[327,46],[327,47],[327,48],[327,49],[328,48],[328,49],[328,50],[328,51],[329,50],[329,51],[329,52],[330,51],[330,52],[331,52],[331,53],[332,52],[332,53],[332,54],[333,53],[333,54],[334,53],[334,54],[334,55],[335,54],[335,55],[336,54],[336,55],[337,55],[337,56],[338,55],[338,56],[339,55],[339,56],[340,56],[340,57],[341,56],[341,57],[342,56],[342,57],[343,56],[343,57],[344,56],[344,57],[345,56],[345,57],[346,56],[346,57],[347,56],[347,57],[348,56],[348,57],[348,58],[349,56],[349,57],[349,58],[350,57],[350,58],[351,57],[351,58],[352,57],[352,58],[353,56],[353,57],[353,58],[354,56],[354,57],[354,58],[355,56],[355,57],[356,55],[356,56],[356,57],[357,55],[357,56],[357,57],[358,55],[358,56],[359,55],[359,56],[360,55],[360,56],[361,54],[361,55],[361,56],[362,54],[362,55],[362,56],[363,54],[363,55],[363,56],[364,55],[364,56],[365,54],[365,55],[365,56],[366,54],[366,55],[367,54],[367,55],[368,54],[368,55],[369,54],[369,55],[370,53],[370,54],[370,55],[371,53],[371,54],[372,53],[372,54],[373,53],[373,54],[374,53],[374,54],[375,52],[375,53],[375,54],[376,52],[376,53],[376,54],[377,52],[377,53],[377,54],[378,52],[378,53],[378,54],[379,52],[379,53],[379,54],[380,52],[380,53],[380,54],[381,52],[381,53],[381,54],[382,52],[382,53],[383,52],[383,53],[384,52],[384,53],[385,52],[385,53]];

	function setup() {
		createCanvas(window.innerWidth, window.innerHeight);

		frameRate(48);

		angleMode(RADIANS);
		noFill();
		colorMode(HSL);

		loadPlanets();
		text = new Text(createVector(width * .5 - 207, height * .8), p, 180);
		clearCanvas();
	}

	function loadPlanets() {
		const pos = createVector(width * .5, height * .5);
		const c = width < height ? width : height;
		const R = c * random(.2, .6);//const R = width * .35;
		const r = c * random(.1, .3);//const r = width * .15;
		const S = random(.001, .005);//const S = .005;
		const s = random(.005, .010);//const s = .01;
		const a = TAU/3;//const a = TAU/3;
		planets.push(new Planet(pos, R, S, 180, a*1));
		planets.push(new Planet(pos, R, S, 240, a*2));
		planets.push(new Planet(pos, R, S, 300, a*3));
		planets[0].addSatellite(new Planet(pos, r, s, 180, a*1));
		planets[1].addSatellite(new Planet(pos, r, s, 240, a*2));
		planets[2].addSatellite(new Planet(pos, r, s, 300, a*3));
	}

	function draw() {
		text.update();
		text.display();
		if (MODE_DEBUG) clearCanvas();
		planets.forEach(p => {
			p.update();
			if (MODE_DEBUG) p.displayHelper();
			else p.display();
		});
	}

	function clearCanvas() {
		background(8);
	}

	class Text {
		constructor (position, points, colorHue) {
			this.position = position;
			this.points = points;
			this.colorHue = colorHue;
			this.size = 1;
			this.speed = 1;
			this.fase = 0;
		}
		update () {
			this.fase += this.speed;
			this.colorHue += .125;
		}
		display () {
			if(this.fase < this.points.length) {
				this.style();
				const p = this.points[this.fase];
				const x = this.position.x + p[0];
				const y = this.position.y + p[1];
				point(x, y);
			}
		}
		style () {
			const c = color(this.colorHue, 60, 70);
			c.setAlpha( .1 );
			strokeWeight(5);
			stroke( c );
		}
	}
	class Planet {
		constructor (position, orbitRadius, speed, colorHue, initialFase) {
			this.orbitCenter = position;
			this.orbitRadius = orbitRadius;
			this.speed = speed;
			this.fase = initialFase;
			this.color = { 'H':colorHue, 'S':80 , 'L': 70, 'a': .05 };
			this.satellites = [];
		}
		addSatellite (planet) {
			this.satellites.push(planet);
		}
		setOrbitCenter (pos) {
			this.orbitCenter = pos;
		}
		getPosition () {
			const x = this.orbitCenter.x + cos( this.fase ) * this.orbitRadius * 0.5 ;
			const y = this.orbitCenter.y + sin( this.fase ) * this.orbitRadius * 0.5 ;
			return createVector(x, y);
		}
		update () {
			this.fase += this.speed;
			if (this.fase >= TAU) this.fase = 0;
			this.satellites.forEach(satellite => {
				satellite.setOrbitCenter(this.getPosition());
				satellite.update();
			});
		}
		display () {
			if (this.satellites.length > 0)
				this.satellites.forEach(sat => {
					this.style();
					sat.display();
				});
			else {
				const p = this.getPosition();
				point(p.x + random(-1, 1), p.y + random(-.5, .5));//line(this.orbitCenter.x, this.orbitCenter.y, p.x, p.y);
			}
		}
		displayHelper () {
			const p = this.getPosition();
			const c = color(this.color['H'], this.color['S'], this.color['L']);
			c.setAlpha( 0.2 ); strokeWeight(30); 
			point(this.orbitCenter.x, this.orbitCenter.y);
			c.setAlpha( 0.25 ); stroke( c );
			point(p.x, p.y);
			c.setAlpha( 0.4 ); strokeWeight(4); stroke( c );
			circle(this.orbitCenter.x, this.orbitCenter.y, this.orbitRadius);
			this.satellites.forEach(satellite => {
				satellite.displayHelper();
			});
		}
		style () {
			const c = color(this.color['H'], this.color['S'], this.color['L']);
			c.setAlpha( this.color['a'] );
			strokeWeight(7);
			stroke( c );
		}
	}
</script>

<!--
	Mini docs
	==========

	Aconseguir l'array de punts del dibuix (text)
	----------

	Script per aconseguir la llista de punts que conformen el trç d'un dibuix:

	```m
	I = imread ("imatge.png");#La imatge ha de ser una imatge que només tingui blanc o negre i dibuixada amb un sol traç
	I = I(:,:,1);

	[Y X] = find(I==0);

	output = '[';

	L = length(X);
	for i = 1:L
		o = sprintf('[%.0f,%.0f]',X(i),Y(i));
		output = strcat(output,',',o);
	end

	output = strcat(output,']');
	disp(output);
	```
-->

</html>