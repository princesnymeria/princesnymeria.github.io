<!DOCTYPE html>

<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">

		<title>Perlinolor</title>
		
		<script src="../p5.js"></script>
	</head>

	<style>
		body {
			padding: 0;
			margin: 0;
			height: 100vh;
			width: 100vw;
			border: none;
			overflow: hidden;
		}
	</style>

	<body></body>

	<script>
		const MODE_DEBUG = true;
		var CANVAS_WIDTH, CANVAS_HEIGHT;
		const brushes = [];

		function setup() {
			CANVAS_WIDTH = window.innerWidth;
			CANVAS_HEIGHT = window.innerHeight;

			createCanvas(CANVAS_WIDTH, CANVAS_HEIGHT);
			frameRate(24);

			setStyle();
			loadBrushes(200);
		}

		function draw() {
			brushes.forEach(b => {
				b.update();
				b.checkMargin();
				b.display();
			});
		}

		function setStyle() {
			background(12);
			colorMode(HSL);
			noFill();
			stroke(0, 60, 60);
			angleMode(RADIANS);
			smooth();
		}

		function loadBrushes(count) {
			const colorHue = random(0, 360);
			for (let i = 0; i < count; i++) {
				const c = color(colorHue, random(10, 90), random(10, 90));
				brushes.push(new Brush(2, c));
			}
		}

		class Brush {
			constructor (size, color) {
				this.pos = createVector(random(0, CANVAS_WIDTH), random(0, CANVAS_HEIGHT));
				this.color = color;
				this.size = size;
			}
			update () {
				const s = 800;
				const v = .4;
				const a = noise(this.pos.x/s, this.pos.y/s) * TAU * s;
				this.pos.x += cos(a) * v;
				this.pos.y += sin(a) * v;
			}
			display () {
				stroke(this.color);
				strokeWeight(this.size);
				point(this.pos.x, this.pos.y);
			}
			checkMargin () {
				if (this.pos.x < 0) this.pos.x = CANVAS_WIDTH;
				if (this.pos.x > CANVAS_WIDTH) this.pos.x = 0;
				if (this.pos.y < 0) this.pos.y = CANVAS_HEIGHT;
				if (this.pos.y > CANVAS_HEIGHT) this.pos.y = 0;
			}
		}
	</script>

</html>