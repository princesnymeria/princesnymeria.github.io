<!DOCTYPE html>
<html lang="en">


<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>See</title>
</head>


<style>
	body {
		margin: 0;
		overflow: hidden;
	}
	#img {
		width: 100vw;
		height: 100vh;
		object-fit: cover;
	}
</style>


<script>
	window.onload = function() {
		loadImage();
		setTimeout(function() {
			var element = document.getElementById('img').contentDocument.documentElement;
			var ar = getGradientAnimationInfo(element);
			setInterval(function(){updateColors(ar)}, 100);
		}, 500);
	};

	function getGradientAnimationInfo (doc) {
		var res = [];
		doc.querySelectorAll('linearGradient.animate').forEach(function (gradient) {
			var resEl ={
				'element': gradient,
				'stops': []
			};
			const stops = gradient.querySelectorAll('stop');
			stops.forEach(stop => {
				const r = /HSL\((\d{1,3}), (\d{1,3})%, (\d{1,3})%\)/g;
				const c = r.exec(stop.getAttribute('stop-color'));
				s = {}
				s['element'] = stop;
				s['H'] = parseInt(c[1]);
				s['S'] = parseInt(c[2]);
				s['L'] = parseInt(c[3]);
				s['increment'] = 2;
				s['Hmin'] = s['H'] - 20;
				s['Hmax'] = s['H'] + 20;
				resEl['stops'].push(s);
			});
			res.push(resEl);
		} );
		return res;
	};

	function loadImage() {
		const imgs = ["desert_amb_temple", "mar_amb_far"];
		const i = Math.floor(Math.random() * imgs.length);
		const o = document.createElement('OBJECT');
		o.id = "img";
		o.data = 'imgs/' + imgs[i] + '.svg';
		o.type = "image/svg+xml";
		document.body.appendChild(o);
	};

	function updateColors (animationInfo) {
		animationInfo.forEach(gradient => {
			gradient.stops.forEach(stop => {
				stop['H'] += stop['increment'];
				if (stop['H'] > stop['Hmax']) s['increment'] *= -1;
				if (stop['H'] < stop['Hmin']) s['increment'] *= -1;
				const c = 'HSL(' + stop['H'] + ', ' + stop['S'] + '%, ' + stop['L'] + '%)';
				stop['element'].setAttribute('stop-color', c);
			});
		});
	};
</script>


<body></body>

</html>